---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading necessary libraries

```{r, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
library(ggplot2)
library(scales)
library(Hmisc)
```

## Loading and preprocessing the data

```{r, results='markup', warning=TRUE, message=TRUE}
if(!file.exists('activity.csv')){
    unzip('activity.zip')
}
activity <- read.csv('activity.csv')
```

## What is mean total number of steps taken per day?

```{r}
dailysteps <- tapply(activity$steps, activity$date, sum, na.rm=TRUE)
```

## What is the average daily activity pattern?

#### 1. Make a histogram of the total number of steps taken each day
```{r}
qplot(dailysteps, xlab='Total steps per day', ylab='Frequency', binwidth=500)
```

#### 2. Calculate and report the mean and median total number of steps taken per day
```{r}
dailystepsMean <- mean(dailysteps)
dailystepsMedian <- median(dailysteps)
```
* Mean: `r dailystepsMean`
* Median:  `r dailystepsMedian`

-----

## What is the average daily activity pattern?
```{r}
averageActivityPattern <- aggregate(x=list(meanSteps=activity$steps), by=list(interval=activity$interval), FUN=mean, na.rm=TRUE)
```

#### 1. Make a time series plot of the 5-minute interval 
```{r}
ggplot(data=averageActivityPattern, aes(x=interval, y=meanSteps)) +
    geom_line() +
    xlab("5-minute interval") +
    ylab("Average Number of Steps") 
```

#### 2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
maxSteps <- which.max(averageActivityPattern$meanSteps)
timeMaxSteps <-  gsub("([0-9]{1,2})([0-9]{2})", "\\1:\\2", averageActivityPattern[maxSteps,'interval'])
```

* Most Steps at: `r timeMaxSteps`

----

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
